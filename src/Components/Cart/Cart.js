import React, { useState } from 'react';
import { useSelector } from 'react-redux';
import CartList from './CartList';
import CartPrice from './CartPrice';
import './Cart.css';
import EmptyCart from './EmptyCart';
import Loader from './Loader';

export default function Cart() {

    const carts = useSelector(state => state.carts);
    const sortedCart = carts.slice().sort((a, b) => (b.quantity - a.quantity));

    const [checkoutStatus, setCheckoutStatus] = useState(false);

    const renderedProduct = sortedCart.map(cart => {
        return (
            <>
                <CartList key={cart.id} cart={cart} />
                <hr className='cart-hr' />
            </>
        )
    })

    const renderedEmpty = () => {
        if (checkoutStatus) {
            return (
                <Loader checkoutStatus={checkoutStatus} setCheckoutStatus={setCheckoutStatus} />)

        } else{
            return (
            <EmptyCart />)
        }
    }

    return (
        <>
            {
                carts.length > 0 ?
                    <div className='cart'>
                        <div className='cart-left'>
                            {renderedProduct}
                        </div>
                        <div className='cart-right'>
                            <CartPrice setCheckoutStatus={setCheckoutStatus} checkoutStatus={checkoutStatus}/>
                        </div>
                    </div>
                    :
                    checkoutStatus ? <Loader checkoutStatus={checkoutStatus} setCheckoutStatus={setCheckoutStatus} /> : <EmptyCart />
                    
            }
        </>
    )
}
